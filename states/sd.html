<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>South Dakota | Travel With The Earps</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root{
      --bg:#f7f4ee;
      --card:#fff;
      --text:#222;
      --muted:#666;
      --border:#e3e3e3;
      --shadow: 0 8px 22px rgba(0,0,0,0.08);
      --radius: 14px;
      --tileH: 260px;
    }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    header{
      padding:28px 18px 10px;
      text-align:center;
    }
    header h1{
      margin:0;
      font-size:2.2rem;
      letter-spacing:0.5px;
    }
    header p{
      margin:10px 0 0;
      color:var(--muted);
    }

    .wrap{
      max-width:1000px;
      margin:0 auto;
      padding:18px;
    }

    .topbar{
      display:flex;
      gap:10px;
      justify-content:flex-start;
      align-items:center;
      margin:8px 0 18px;
      flex-wrap: wrap;
    }

    .back{
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color:var(--text);
      background:var(--card);
      border:1px solid #ddd;
      padding:10px 12px;
      border-radius:10px;
    }

    .section-title{
      margin:22px 0 10px;
      font-size:1.15rem;
    }

    .hint{
      margin:0 0 12px;
      color:var(--muted);
      font-size:0.95rem;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap:14px;
    }

    .tile{
      margin:0;
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
    }

    /* Photos */
    .tile img{
      width:100%;
      display:block;
      height:var(--tileH);
      object-fit:cover;
      cursor:pointer;
    }

    /* Videos */
    .tile video{
      width:100%;
      height:var(--tileH);
      display:block;
      object-fit:cover;
      background:#000;
      cursor:pointer;
    }

    footer{
      padding:30px 18px 50px;
      text-align:center;
      color:#777;
      font-size:0.95rem;
    }

    /* ---------- VIDEO MODAL ---------- */
    .video-modal[hidden] { display:none; }
    .video-modal{
      position:fixed;
      inset:0;
      z-index:9999;
    }
    .video-modal-backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,0.72);
    }
    .video-modal-content{
      position:relative;
      width:min(900px, 92vw);
      margin:8vh auto 0;
      background:#000;
      border-radius:12px;
      overflow:hidden;
    }
    .video-modal-content video{
      width:100%;
      display:block;
    }
    .video-close{
      position:absolute;
      top:10px;
      right:10px;
      z-index:10000;
      width:34px;
      height:34px;
      border:0;
      border-radius:10px;
      background: rgba(255,255,255,0.95);
      font-size:18px;
      cursor:pointer;
    }

    /* ---------- IMAGE MODAL ---------- */
    .image-modal[hidden] { display:none; }
    .image-modal{
      position:fixed;
      inset:0;
      z-index:9000;
    }
    .image-modal-backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,0.75);
    }
    .image-modal-content{
      position:relative;
      width:min(92vw, 1100px);
      margin:6vh auto;
    }
    .image-modal-content img{
      width:100%;
      height:auto;
      display:block;
      border-radius:12px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
    }
    .image-close{
      position:absolute;
      top:10px;
      right:10px;
      z-index:9100;
      width:34px;
      height:34px;
      border:0;
      border-radius:10px;
      background: rgba(255,255,255,0.95);
      font-size:18px;
      cursor:pointer;
    }
  </style>
</head>

<body>
  <header>
    <h1>South Dakota</h1>
    <p>Our favorite moments in SD.</p>
  </header>

  <div class="wrap">
    <div class="topbar">
      <a class="back" href="../index.html">← Back to Map</a>
    </div>

    <!-- TOP 5 (state sign first) -->
    <h2 class="section-title">Top Photos</h2>
    <p class="hint">Click any photo to expand.</p>

    <div class="grid">
      <figure class="tile">
        <img class="expandable-image" src="../images/sd/sd-01.jpg" alt="South Dakota state sign" loading="lazy" />
      </figure>
      <figure class="tile">
        <img class="expandable-image" src="../images/sd/sd-02.jpg" alt="South Dakota photo" loading="lazy" />
      </figure>
      <figure class="tile">
        <img class="expandable-image" src="../images/sd/sd-03.jpg" alt="South Dakota photo" loading="lazy" />
      </figure>
      <figure class="tile">
        <img class="expandable-image" src="../images/sd/sd-04.jpg" alt="South Dakota photo" loading="lazy" />
      </figure>
      <figure class="tile">
        <img class="expandable-image" src="../images/sd/sd-05.jpg" alt="South Dakota photo" loading="lazy" />
      </figure>
    </div>

    <!-- VIDEOS -->
    <h2 class="section-title">Videos</h2>
    <p class="hint">Autoplay previews are muted. Click to play with sound.</p>

    <div class="grid">
      <figure class="tile">
        <video
          class="preview-video"
          autoplay muted loop playsinline webkit-playsinline
          preload="metadata"
          data-full="../images/sd/sd-02.mp4"
        >
          <source src="../images/sd/sd-02.mp4" type="video/mp4" />
        </video>
      </figure>

      <figure class="tile">
        <video
          class="preview-video"
          autoplay muted loop playsinline webkit-playsinline
          preload="metadata"
          data-full="../images/sd/sd-16.mp4"
        >
          <source src="../images/sd/sd-16.mp4" type="video/mp4" />
        </video>
      </figure>
    </div>

    <!-- ALL PHOTOS -->
    <h2 class="section-title">All Photos</h2>
    <p class="hint">Everything else in the SD folder (auto-detected by filename).</p>

    <div id="all-photos" class="grid"></div>
  </div>

  <footer>© Travel With The Earps</footer>

  <!-- Video Modal -->
  <div class="video-modal" hidden>
    <div class="video-modal-backdrop"></div>
    <div class="video-modal-content" role="dialog" aria-modal="true" aria-label="Video player">
      <button class="video-close" type="button" aria-label="Close video">✕</button>
      <video class="video-modal-player" controls playsinline></video>
    </div>
  </div>

  <!-- Image Modal -->
  <div class="image-modal" hidden>
    <div class="image-modal-backdrop"></div>
    <div class="image-modal-content" role="dialog" aria-modal="true" aria-label="Image viewer">
      <button class="image-close" type="button" aria-label="Close image">✕</button>
      <img class="image-modal-img" alt="" />
    </div>
  </div>

  <script>
    // ---------- VIDEO MODAL ----------
    const previews = document.querySelectorAll(".preview-video");
    const vModal = document.querySelector(".video-modal");
    const vBackdrop = document.querySelector(".video-modal-backdrop");
    const vCloseBtn = document.querySelector(".video-close");
    const vPlayer = document.querySelector(".video-modal-player");

    function openVideo(src){
      vPlayer.src = src;
      vModal.hidden = false;
      vPlayer.play().catch(() => {});
    }

    function closeVideo(){
      vPlayer.pause();
      vPlayer.removeAttribute("src");
      vPlayer.load();
      vModal.hidden = true;
    }

    previews.forEach(v => {
      v.addEventListener("click", () => {
        const full = v.dataset.full || v.querySelector("source")?.src;
        if (full) openVideo(full);
      });
    });

    vBackdrop.addEventListener("click", closeVideo);
    vCloseBtn.addEventListener("click", closeVideo);

    // ---------- IMAGE MODAL ----------
    const imgModal = document.querySelector(".image-modal");
    const imgBackdrop = document.querySelector(".image-modal-backdrop");
    const imgClose = document.querySelector(".image-close");
    const modalImg = document.querySelector(".image-modal-img");

    function openImage(src, alt){
      modalImg.src = src;
      modalImg.alt = alt || "";
      imgModal.hidden = false;
    }

    function closeImage(){
      modalImg.src = "";
      imgModal.hidden = true;
    }

    function bindExpandableImages(){
      document.querySelectorAll(".expandable-image").forEach(img => {
        img.addEventListener("click", () => openImage(img.src, img.alt));
      });
    }

    imgBackdrop.addEventListener("click", closeImage);
    imgClose.addEventListener("click", closeImage);

    // Close modals with ESC
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape"){
        if (!vModal.hidden) closeVideo();
        if (!imgModal.hidden) closeImage();
      }
    });

    // ---------- ALL PHOTOS AUTO-ADD ----------
    // Assumes your naming convention sd-01.jpg, sd-02.jpg, etc.
    // Skips 01-05 since those are in Top Photos.
    const allPhotosWrap = document.getElementById("all-photos");
    const SKIP = new Set([1,2,3,4,5]);
    const MAX = 200; // bump up if you ever have more than 200

    function pad2(n){ return String(n).padStart(2, "0"); }

    function addPhoto(n){
      const src = `../images/sd/sd-${pad2(n)}.jpg`;

      const fig = document.createElement("figure");
      fig.className = "tile";

      const img = document.createElement("img");
      img.className = "expandable-image";
      img.src = src;
      img.alt = `South Dakota photo ${pad2(n)}`;
      img.loading = "lazy";

      // only keep it if it loads (file exists)
      img.addEventListener("error", () => fig.remove());

      fig.appendChild(img);
      allPhotosWrap.appendChild(fig);
    }

    // Build list
    for (let n = 1; n <= MAX; n++){
      if (SKIP.has(n)) continue;
      addPhoto(n);
    }

    // bind click-to-expand for top photos and all loaded ones
    bindExpandableImages();
  </script>
</body>
</html>
